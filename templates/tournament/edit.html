{% extends "base.html" %}

{% block title %}Edit {{ tournament.name }} - Kickoff Arena{% endblock %}

{% block main_class %}pt-16{% endblock %}

{% block extra_head %}
<style>
    /* Enhanced hero gradient matching other pages */
    .hero-gradient {
        background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 25%, #99f6e4 50%, #5eead4 75%, #2dd4bf 100%);
        position: relative;
        overflow: hidden;
    }
    
    .hero-gradient::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
        animation: float 20s infinite linear;
    }
    
    .floating-shape {
        position: absolute;
        opacity: 0.1;
        animation: float 6s ease-in-out infinite;
    }
    
    .floating-shape:nth-child(1) { top: 20%; left: 10%; animation-delay: 0s; }
    .floating-shape:nth-child(2) { top: 60%; right: 20%; animation-delay: 2s; }
    .floating-shape:nth-child(3) { top: 40%; left: 80%; animation-delay: 4s; }
    .floating-shape:nth-child(4) { bottom: 20%; left: 20%; animation-delay: 1s; }
    .floating-shape:nth-child(5) { bottom: 40%; right: 10%; animation-delay: 3s; }
    
    @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(180deg); }
    }
    
    /* Enhanced feature card styling matching explore page */
    .feature-card {
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        border: 1px solid rgba(16, 185, 129, 0.1);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        backdrop-filter: blur(20px);
    }
    
    .feature-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.05), transparent);
        transition: left 0.6s ease;
    }
    
    .feature-card:hover::before {
        left: 100%;
    }
    
    .feature-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 25px 50px rgba(16, 185, 129, 0.15);
        border-color: rgba(16, 185, 129, 0.2);
    }
    
    /* Enhanced form section styling */
    .form-section {
        background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
        border: 1px solid rgba(16, 185, 129, 0.08);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }
    
    .form-section:hover {
        transform: translateY(-2px);
        box-shadow: 0 15px 30px rgba(16, 185, 129, 0.08);
        border-color: rgba(16, 185, 129, 0.15);
    }
    
    /* Enhanced input styling */
    .form-input {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        border: 2px solid #e5e7eb;
    }
    
    .form-input:hover {
        border-color: #d1d5db;
        background: #ffffff;
    }
    
    .form-input:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        transform: translateY(-1px);
        background: #ffffff;
    }
    
    .section-icon {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }
    
    /* Enhanced buttons matching design system */
    .btn-primary {
        background: linear-gradient(135deg, #10b981, #34d399);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }
    
    .btn-primary::before {
        content: '';
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(45deg, #fbbf24, #f59e0b, #10b981, #34d399);
        border-radius: inherit;
        z-index: -1;
        filter: blur(8px);
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .btn-primary:hover::before {
        opacity: 0.7;
    }
    
    .btn-primary:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 20px 40px rgba(16, 185, 129, 0.3);
    }
    
    /* Gradient text matching index page */
    .gradient-text {
        background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    /* Animate on entry */
    .animate-fadeIn {
        animation: fadeIn 0.6s ease-out;
    }
    
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <!-- Hero Header -->
    <div class="hero-gradient border-b border-green-100">
        <!-- Enhanced Floating Background Shapes -->
        <div class="floating-shape w-16 h-16 bg-white rounded-full"></div>
        <div class="floating-shape w-12 h-12 bg-yellow-300 rounded-full"></div>
        <div class="floating-shape w-20 h-20 bg-white rounded-full"></div>
        <div class="floating-shape w-14 h-14 bg-green-200 rounded-full"></div>
        <div class="floating-shape w-8 h-8 bg-white rounded-full"></div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Breadcrumb -->
            <nav class="flex text-sm text-gray-600 mb-4" aria-label="Breadcrumb">
                <ol class="flex items-center space-x-2">
                    <li><a href="{{ url_for('main.index') }}" class="hover:text-gray-900"><i class="fas fa-home"></i></a></li>
                    <li><i class="fas fa-chevron-right text-gray-400 text-[10px] mx-2"></i></li>
                    <li><a href="{{ url_for('tournament.view', tournament_id=tournament.id) }}" class="hover:text-gray-900">{{ tournament.name }}</a></li>
                    <li><i class="fas fa-chevron-right text-gray-400 text-[10px] mx-2"></i></li>
                    <li class="text-gray-900 font-semibold">Edit Tournament</li>
                </ol>
            </nav>
            
            <!-- Header Content -->
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 bg-green-500 rounded-2xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-edit text-white text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl md:text-3xl font-black text-gray-900">Edit Tournament</h1>
                        <p class="text-gray-700">Modify settings and details for <span class="font-semibold text-green-600">{{ tournament.name }}</span></p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3">
                    <!-- Tournament Info -->
                    <div class="bg-white/80 backdrop-blur-sm rounded-xl px-4 py-2 border border-green-100">
                        <div class="text-xs text-gray-600 font-semibold">Tournament Configuration</div>
                        <div class="text-sm font-black text-green-600">Live Editor</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Enhanced Edit Form -->
        <div class="feature-card rounded-2xl shadow-xl overflow-hidden animate-fadeIn">
            <!-- Form Header -->
            <div class="px-8 py-6 bg-gradient-to-r from-green-50 to-green-100 border-b border-green-200">
                <h2 class="text-xl font-black text-gray-900 flex items-center">
                    <i class="fas fa-cog text-green-600 mr-3"></i>
                    Tournament Configuration
                </h2>
                <p class="text-green-700 mt-1">Update your tournament settings and details</p>
            </div>
            
            <div class="px-8 py-8">
                <form method="POST" class="space-y-6">
                    <!-- Basic Information -->
                    <div class="form-section rounded-xl p-6 mb-8">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 section-icon rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-info-circle text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-black text-gray-900">Basic Information</h2>
                                <p class="text-sm text-gray-600">Tournament name and description</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 gap-6">
                            <div class="relative">
                                <label for="name" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-trophy text-green-500 mr-2"></i>
                                    Tournament Name *
                                </label>
                                <input type="text" id="name" name="name" value="{{ tournament.name }}" required
                                       class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                                    <i class="fas fa-trophy text-green-500"></i>
                                </div>
                            </div>
                            
                            <div>
                                <label for="description" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-align-left text-green-500 mr-2"></i>
                                    Description
                                </label>
                                <textarea id="description" name="description" rows="4"
                                          class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium resize-none"
                                          placeholder="Describe your tournament...">{{ tournament.description }}</textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Tournament Configuration -->
                    <div class="form-section rounded-xl p-6 mb-8">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 section-icon rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-cogs text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-black text-gray-900">Tournament Configuration</h2>
                                <p class="text-sm text-gray-600">Format and competition type settings</p>
                            </div>
                        </div>
                        
                        <!-- Warning for changing tournament type -->
                        <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-xl p-4 mb-6">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-exclamation-triangle text-yellow-400 text-lg"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-yellow-800">
                                        Important: Changing Tournament Type
                                    </h3>
                                    <p class="mt-1 text-sm text-yellow-700">
                                        Changing from Solo to Team (or vice versa) may affect existing participants, teams, and matches. 
                                        Make sure to review your tournament data after making this change.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label for="sport" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-gamepad text-green-500 mr-2"></i>
                                    Sport/Game *
                                </label>
                                <select id="sport" name="sport" required
                                        class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                    <option value="">Select a sport/game</option>
                                    <option value="Football" {% if tournament.sport == 'Football' %}selected{% endif %}>Football</option>
                                    <option value="fifa" {% if tournament.sport == 'fifa' %}selected{% endif %}>FIFA</option>
                                    <option value="soccer" {% if tournament.sport == 'soccer' %}selected{% endif %}>Soccer</option>
                                    <option value="basketball" {% if tournament.sport == 'basketball' %}selected{% endif %}>Basketball</option>
                                    <option value="tennis" {% if tournament.sport == 'tennis' %}selected{% endif %}>Tennis</option>
                                    <option value="volleyball" {% if tournament.sport == 'volleyball' %}selected{% endif %}>Volleyball</option>
                                    <option value="other" {% if tournament.sport == 'other' %}selected{% endif %}>Other</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="format" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-sitemap text-green-500 mr-2"></i>
                                    Tournament Format *
                                </label>
                                <select id="format" name="format" required
                                        class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                    <option value="">Select format</option>
                                    <option value="single_elimination" {% if tournament.format == 'single_elimination' %}selected{% endif %}>Single Elimination</option>
                                    <option value="double_elimination" {% if tournament.format == 'double_elimination' %}selected{% endif %}>Double Elimination</option>
                                    <option value="round_robin" {% if tournament.format == 'round_robin' %}selected{% endif %}>Round Robin</option>
                                    <option value="league" {% if tournament.format == 'league' %}selected{% endif %}>League</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="tournament_type" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-users text-green-500 mr-2"></i>
                                    Tournament Type *
                                </label>
                                <select id="tournament_type" name="tournament_type" required onchange="toggleTournamentTypeFields()"
                                        class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                    <option value="solo" {% if tournament.type == 'solo' %}selected{% endif %}>Solo (1v1)</option>
                                    <option value="team" {% if tournament.type == 'team' %}selected{% endif %}>Team</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-2 bg-gray-50 px-3 py-2 rounded-lg">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    Solo tournaments are individual competitions, Team tournaments are for groups
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Capacity Settings -->
                    <div class="form-section rounded-xl p-6 mb-8">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 section-icon rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-users text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-black text-gray-900">Capacity Settings</h2>
                                <p class="text-sm text-gray-600">Set maximum participants or teams</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 gap-6">
                            <div id="solo-fields" class="transition-all duration-300" {% if tournament.type != 'solo' %}style="display: none;"{% endif %}>
                                <label for="max_participants" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-user text-green-500 mr-2"></i>
                                    Maximum Participants
                                </label>
                                <input type="number" id="max_participants" name="max_participants" 
                                       value="{{ tournament.max_participants or 32 }}" min="2" max="128"
                                       class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                <p class="text-xs text-gray-500 mt-2 bg-gray-50 px-3 py-2 rounded-lg">Number of individual players (2-128)</p>
                            </div>
                            
                            <div id="team-fields" class="transition-all duration-300 space-y-4" {% if tournament.type == 'solo' %}style="display: none;"{% endif %}>
                                <div>
                                    <label for="max_teams" class="block text-sm font-bold text-gray-700 mb-2">
                                        <i class="fas fa-users text-green-500 mr-2"></i>
                                        Maximum Teams
                                    </label>
                                    <input type="number" id="max_teams" name="max_teams" 
                                           value="{{ tournament.max_teams or 16 }}" min="2" max="64"
                                           class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                    <p class="text-xs text-gray-500 mt-2 bg-gray-50 px-3 py-2 rounded-lg">Number of teams (2-64)</p>
                                </div>
                                <div>
                                    <label for="max_players_per_team" class="block text-sm font-bold text-gray-700 mb-2">
                                        <i class="fas fa-user-friends text-green-500 mr-2"></i>
                                        Players per Team
                                    </label>
                                    <input type="number" id="max_players_per_team" name="max_players_per_team" 
                                           value="{{ tournament.max_players_per_team or 5 }}" min="1" max="20"
                                           class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                    <p class="text-xs text-gray-500 mt-2 bg-gray-50 px-3 py-2 rounded-lg">Maximum players per team (1-20)</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Schedule -->
                    <div class="form-section rounded-xl p-6 mb-8">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 section-icon rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-calendar text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-black text-gray-900">Schedule</h2>
                                <p class="text-sm text-gray-600">Tournament dates and deadlines</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label for="start_date" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-play-circle text-green-500 mr-2"></i>
                                    Start Date
                                </label>
                                <input type="date" id="start_date" name="start_date" 
                                       value="{{ tournament.start_date[:10] if tournament.start_date else '' }}"
                                       class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                            </div>
                            
                            <div>
                                <label for="end_date" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-stop-circle text-green-500 mr-2"></i>
                                    End Date
                                </label>
                                <input type="date" id="end_date" name="end_date" 
                                       value="{{ tournament.end_date[:10] if tournament.end_date else '' }}"
                                       class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                            </div>
                            
                            <div id="registration-deadline-field">
                                <label for="registration_deadline" class="block text-sm font-bold text-gray-700 mb-2">
                                    <i class="fas fa-user-plus text-green-500 mr-2"></i>
                                    Registration Deadline
                                </label>
                                <input type="date" id="registration_deadline" name="registration_deadline" 
                                       value="{{ tournament.registration_deadline[:10] if tournament.registration_deadline else '' }}"
                                       class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                <p class="text-xs text-gray-500 mt-2">Only required when Registration Status is set to "Registration Open"</p>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Location and Rules Section -->
                    <div class="form-section rounded-xl p-6 mb-8">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 section-icon rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-map-marker-alt text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-black text-gray-900">Location and Rules</h2>
                                <p class="text-sm text-gray-600">Tournament venue and regulations</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 gap-6">
                            <div>
                                <label for="location" class="block text-sm font-bold text-gray-800 mb-4 flex items-center">
                                    <div class="w-6 h-6 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-map-marker-alt text-white text-xs"></i>
                                    </div>
                                    Tournament Location
                                </label>
                                <input type="text" id="location" name="location" value="{{ tournament.location or '' }}"
                                       class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium"
                                       placeholder="e.g., Online, Gaming Center, Stadium">
                                <p class="text-xs text-gray-500 mt-2 ml-9">Where will the tournament take place?</p>
                            </div>
                            
                            <div>
                                <label for="rules" class="block text-sm font-bold text-gray-800 mb-4 flex items-center">
                                    <div class="w-6 h-6 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-gavel text-white text-xs"></i>
                                    </div>
                                    Tournament Rules & Guidelines
                                </label>
                                <textarea id="rules" name="rules" rows="6"
                                          class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium resize-none"
                                          placeholder="Define your tournament rules...&#10;&#10;Example rules:&#10;• All matches must be completed within 24 hours&#10;• No pausing during matches except for technical issues&#10;• Players must use default camera settings&#10;• Disconnections: Winner determined by current score&#10;• Disputes resolved by tournament admin">{{ tournament.rules }}</textarea>
                                <p class="text-xs text-gray-500 mt-2 ml-9">Clear rules help prevent disputes and ensure fair play</p>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Prize & Entry Section -->
                    <div class="form-section rounded-xl p-6 mb-8">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 section-icon rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-dollar-sign text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-black text-gray-900">Prize & Entry Fees</h2>
                                <p class="text-sm text-gray-600">Set entry costs and prize rewards</p>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-yellow-50 to-amber-50 rounded-2xl p-8 border border-yellow-200">
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                <div>
                                    <label for="entry_fee" class="block text-sm font-bold text-gray-800 mb-4 flex items-center">
                                        <div class="w-6 h-6 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center mr-3">
                                            <i class="fas fa-ticket-alt text-white text-xs"></i>
                                        </div>
                                        Entry Fee (USD $)
                                    </label>
                                    <div class="relative">
                                        <span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium">$</span>
                                        <input type="number" id="entry_fee" name="entry_fee" 
                                               value="{{ tournament.entry_fee or 0 }}" min="0" step="0.01"
                                               class="form-input w-full pl-8 pr-4 py-3 rounded-xl shadow-sm font-medium">
                                    </div>
                                    <p class="text-xs text-gray-500 mt-2 ml-9">Set to $0 for completely free tournaments</p>
                                </div>
                                
                                <div>
                                    <label for="prize_pool" class="block text-sm font-bold text-gray-800 mb-4 flex items-center">
                                        <div class="w-6 h-6 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-lg flex items-center justify-center mr-3">
                                            <i class="fas fa-trophy text-white text-xs"></i>
                                        </div>
                                        Total Prize Pool (USD $)
                                    </label>
                                    <div class="relative">
                                        <span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium">$</span>
                                        <input type="number" id="prize_pool" name="prize_pool" 
                                               value="{{ tournament.prize_pool or 0 }}" min="0" step="0.01"
                                               class="form-input w-full pl-8 pr-4 py-3 rounded-xl shadow-sm font-medium">
                                    </div>
                                    <p class="text-xs text-gray-500 mt-2 ml-9">Total amount distributed to winners</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Registration & Visibility Settings -->
                    <div class="form-section rounded-xl p-6 mb-8">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 section-icon rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-cog text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-black text-gray-900">Registration & Visibility</h2>
                                <p class="text-sm text-gray-600">Control registration status and tournament visibility</p>
                            </div>
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Registration Status -->
                            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6">
                                <label for="status" class="block text-sm font-bold text-gray-900 mb-4">
                                    <i class="fas fa-flag text-blue-600 mr-2"></i>
                                    Registration Status
                                </label>
                                <select id="status" name="status" 
                                        class="form-input w-full px-4 py-3 rounded-xl shadow-sm font-medium">
                                    <option value="draft" {% if tournament.status == 'draft' %}selected{% endif %}>Draft - Not visible to public</option>
                                    <option value="registration_open" {% if tournament.status == 'registration_open' %}selected{% endif %}>Registration Open - Users can register</option>
                                    <option value="upcoming" {% if tournament.status == 'upcoming' %}selected{% endif %}>Upcoming - Registration closed, tournament not started</option>
                                    <option value="in_progress" {% if tournament.status == 'in_progress' %}selected{% endif %}>In Progress - Tournament currently running</option>
                                    <option value="completed" {% if tournament.status == 'completed' %}selected{% endif %}>Completed - Tournament finished</option>
                                </select>
                                <div class="mt-3 space-y-2 text-xs">
                                    <div class="flex items-center text-green-600">
                                        <i class="fas fa-lightbulb mr-2"></i>
                                        <span><strong>Registration Open:</strong> Users can register for this tournament on the public page</span>
                                    </div>
                                    <div class="flex items-center text-amber-600">
                                        <i class="fas fa-info-circle mr-2"></i>
                                        <span><strong>Draft:</strong> Tournament is not visible to public users until status changes</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Public Visibility -->
                            <div class="bg-white border-2 border-green-200 rounded-2xl p-6">
                                <div class="flex items-start">
                                    <input type="checkbox" id="is_public" name="is_public" 
                                           {% if tournament.is_public %}checked{% endif %}
                                           class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded mt-1">
                                    <div class="ml-4">
                                        <label for="is_public" class="block text-sm font-bold text-gray-900 mb-2">
                                            <i class="fas fa-globe mr-2 text-green-600"></i>Make Tournament Public
                                        </label>
                                        <p class="text-sm text-gray-600">Public tournaments appear in search results and can be discovered by anyone. Private tournaments are only accessible via direct links.</p>
                                        <div class="mt-3 text-xs text-green-600 font-medium">
                                            <i class="fas fa-check-circle mr-1"></i>Required for users to register via the public tournament page
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Action Buttons -->
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between pt-8 border-t-2 border-gray-100 mt-10 space-y-4 sm:space-y-0">
                        <div class="text-sm text-gray-500">
                            <i class="fas fa-lightbulb mr-1 text-yellow-500"></i>
                            Tip: Changes are saved immediately and will affect the tournament
                        </div>
                        
                        <div class="flex space-x-4">
                            <a href="{{ url_for('tournament.view', tournament_id=tournament.id) }}" 
                               class="inline-flex items-center px-6 py-3 border-2 border-gray-300 rounded-xl shadow-sm text-sm font-bold text-gray-700 bg-white hover:bg-gray-50 hover:border-green-300 transition-all duration-200 hover:-translate-y-1">
                                <i class="fas fa-arrow-left mr-2"></i> Back to Tournament
                            </a>
                            
                            <button type="submit"
                                    class="btn-primary inline-flex items-center px-6 py-3 border border-transparent rounded-xl shadow-lg text-sm font-bold text-white">
                                <i class="fas fa-save mr-2"></i>
                                Save Changes
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
function toggleTournamentTypeFields() {
    const tournamentType = document.getElementById('tournament_type').value;
    const soloFields = document.getElementById('solo-fields');
    const teamFields = document.getElementById('team-fields');
    
    if (tournamentType === 'solo') {
        soloFields.style.display = 'block';
        teamFields.style.display = 'none';
    } else {
        soloFields.style.display = 'none';
        teamFields.style.display = 'block';
    }
}
// Toggle registration deadline visibility based on status
function toggleRegistrationDeadlineVisibility() {
    const statusEl = document.getElementById('status');
    const container = document.getElementById('registration-deadline-field');
    if (!statusEl || !container) return;
    const open = statusEl.value === 'registration_open';
    container.style.display = open ? 'block' : 'none';
    const input = document.getElementById('registration_deadline');
    if (input) {
        input.disabled = !open;
        if (!open) input.value = '';
    }
}

document.addEventListener('DOMContentLoaded', function() {
    const statusEl = document.getElementById('status');
    if (statusEl) {
        statusEl.addEventListener('change', toggleRegistrationDeadlineVisibility);
        toggleRegistrationDeadlineVisibility();
    }
});
</script>
{% endblock %}
